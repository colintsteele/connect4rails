<h1>Hello SalesLoft!</h1>
<p>Press the buttons below to dropp discs onto the board.</p>

<div id="winner"></div>

<button onclick="reset()">Reset board</button>
<span id="player-turn">player <%= @board.current_player.number %>'s turn</span>


<div id="board" style="position:relative;">
  <canvas id="canboard"
          height="<%=(@board.height*@canvas_scale)%>"
          width="<%=(@board.width*@canvas_scale)%>">
  </canvas>

  <script>
    $(document).ready(function(){
      //create buttons for dropping discs into columns
      <% 7.times do |i| %>
        $('<button/>', {
          id: 'drop_slot<%=i%>',
          class: 'drop_slot'
        }).on('click', function(){
          $.ajax({
            url: 'board/drop_disc?column=<%=i%>',
            type: 'GET',
            success: function(result){
              drawDisc(result.color, result.coords[0], result.coords[1]);
              $('#player-turn').text("player "+result.opponent+"'s turn");
              $.ajax({
                url: 'board/check_game_over',
                type: 'GET',
                success: function(status){
                  if(status.winner != undefined) {
                    if(confirm("Player "+status.winner+" has won!!  Press okay to reset the board"))
                      reset();
                  } else if (status.tie == "true"){
                    if(confirm("Tie!!  Press okay to reset the board."))
                      reset();
                  }
                }
              })
            }
          });
        }).appendTo($('#board'));
      <%end%>
    });
  </script>
</div>

<div id="progress-board"
     style="border-color: black;
     border-style: solid;
     border-radius: 2px;
     padding: 2px;
     float: right">

  <ul>
    <li class="done">Deploy</li>
    <li class="done">Disc logic</li>
    <li class="done">UI</li>
    <li class="done">Game logic</li>
    <li class="done">Win conditions</li>
    <li class="in-progress">Database saves</li>
    <li class="tbd">AI</li>
  </ul>

</div>
<script type="text/javascript">
</script>
